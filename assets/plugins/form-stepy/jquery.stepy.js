!function(l){var r={init:function(e){return this.each(function(){r.destroy.call(this),this.opt=l.extend({},l.fn.stepy.defaults,e);var a=this,n=l(this);if(void 0===(t=n.attr("id"))||""===t){var t=r._hash.call(a);n.attr("id",t)}a.opt.validate&&(jQuery.validator.setDefaults({ignore:a.opt.ignore}),n.append('<div class="stepy-errors" />')),a.header=r._header.call(a),a.steps=n.children("fieldset"),a.steps.each(function(t){r._createHead.call(a,this,t),r._createButtons.call(a,this,t)}),a.heads=a.header.children("li"),a.heads.first().addClass("stepy-active"),a.opt.finishButton&&r._bindFinish.call(a),a.opt.titleClick?a.heads.click(function(){var t=a.heads.filter(".stepy-active").attr("id").split("-"),e=parseInt(t[t.length-1],10),i=l(this).index();if(e<i){if(a.opt.next&&!r._execute.call(n,a.opt.next,i))return!1}else if(i<e&&a.opt.back&&!r._execute.call(n,a.opt.back,i))return!1;i!=e&&r.step.call(a,i+1)}):a.heads.css("cursor","default"),a.opt.enter&&r._bindEnter.call(a),a.steps.first().find(":input:visible:enabled").first().select().focus(),n.data({settings:this.opt,stepy:!0})})},_bindEnter:function(){var a=this;a.steps.delegate('input[type="text"], input[type="password"]',"keypress",function(t){if(13==(t.keyCode?t.keyCode:t.which)){t.preventDefault();var e=l(this).closest("fieldset").find(".stepy-navigator");if(e.length){var i=e.children(".button-next");i.length?i.click():a.finish&&a.finish.click()}}})},_bindFinish:function(){var e=this,i=l(this),t=i.children('input[type="submit"]');if(e.finish=1===t.length?t:i.children(".btn .btn-succes .stepy-finish"),e.finish.length){var a=i.is("form"),n=void 0;a&&e.opt.finish&&(n=i.attr("onsubmit"),i.attr("onsubmit","return false;")),e.finish.on("click.stepy",function(t){if(e.opt.finish&&!r._execute.call(i,e.opt.finish,e.steps.length-1))t.preventDefault();else if(a){n?i.attr("onsubmit",n):i.removeAttr("onsubmit"),"submit"===e.finish.attr("type")||e.opt.validate&&!r.validate.call(i,e.steps.length-1)||i.submit()}}),e.steps.last().children(".stepy-navigator").append(e.finish)}else l.error('Submit button or element with class "stepy-finish" missing!')},_createBackButton:function(t,e){var i=this,a=(l(this),{href:"#",class:"btn btn-default",html:i.opt.backLabel});l("<a />",a).on("click.stepy",function(t){t.preventDefault(),i.opt.back&&!r._execute.call(i,i.opt.back,e-1)||r.step.call(i,e-1+1)}).appendTo(t)},_createButtons:function(t,e){var i=r._navigator.call(this).appendTo(t);0===e?1<this.steps.length&&r._createNextButton.call(this,i,e):(l(t).hide(),r._createBackButton.call(this,i,e),e<this.steps.length-1&&r._createNextButton.call(this,i,e))},_createHead:function(t,e){t=l(t).attr("id",l(this).attr("id")+"-step-"+e).addClass("stepy-step");var i=r._head.call(this,e);i.append(r._title.call(this,t)),this.opt.description&&i.append(r._description.call(this,t)),this.header.append(i)},_createNextButton:function(t,e){var i=this,a=l(this),n={href:"#",class:"btn btn-primary",html:i.opt.nextLabel};l("<a/>",n).on("click.stepy",function(t){t.preventDefault(),i.opt.next&&!r._execute.call(a,i.opt.next,e+1)||r.step.call(i,e+1+1)}).appendTo(t)},_description:function(t){var e=t.children("legend");if(this.opt.legend||e.hide(),e.length)return l("<span />",{html:e.html()});r._error.call(this,"<legend /> element missing!")},_error:function(t){l(this).html(t),l.error(t)},_execute:function(t,e){var i=t.call(this,e+1);return i||void 0===i},_hash:function(){return this.hash="stepy-"+Math.random().toString().substring(2),this.hash},_head:function(t){return l("<li />",{id:l(this).attr("id")+"-head-"+t})},_header:function(){var t=l("<ul />",{id:l(this).attr("id")+"-header",class:"stepy-header"});return this.opt.titleTarget?t.appendTo(this.opt.titleTarget):t.insertBefore(this),t},_navigator:function(t){return l('<div class="stepy-navigator panel-footer" />')},_title:function(t){return l("<div />",{html:t.attr("title")||"--"})},destroy:function(){return l(this).each(function(){var t=l(this);if(t.data("stepy")){var e=t.data("stepy",!1).children("fieldset").css("display","");t.children(".stepy-errors").remove(),this.finish.appendTo(e.last()),e.find(".stepy-navigator").remove()}})},step:function(t){that=l(this),opt=that[0].opt,t--;var e=that.children("fieldset");t>e.length-1&&(t=e.length-1);var i=t;if(opt.validate)for(var a=!0,n=0;n<t;n++)if(a&=r.validate.call(this,n),opt.block&&!a){i=n;break}var s=e.length;if("fade"==opt.transition?e.fadeOut(opt.duration,function(){0<--s||e.eq(i).fadeIn(opt.duration)}):"slide"==opt.transition?e.slideUp(opt.duration,function(){0<--s||e.eq(i).slideDown(opt.duration)}):e.hide(opt.duration).eq(i).show(opt.duration),that[0].heads.removeClass("stepy-active").eq(i).addClass("stepy-active"),that.is("form")){(i==t?e.eq(i).find(":input:enabled:visible"):e.eq(i).find(".error").select().focus()).first().select().focus()}return opt.select&&opt.select.call(this,i+1),that},validate:function(t){var e=l(this);if(!e.is("form"))return!0;var i=this,a=e.children("fieldset").eq(t),n=!0,s=l("#"+e.attr("id")+"-header").children().eq(t),r=e.validate();return l(a.find(":input:enabled").get().reverse()).each(function(){var t=r.element(l(this));void 0===t&&(t=!0),(n&=t)?i.opt.errorImage&&s.removeClass("stepy-error"):(i.opt.errorImage&&s.addClass("stepy-error"),r.focusInvalid())}),n}};l.fn.stepy=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void l.error("Method "+t+" does not exist!"):r.init.apply(this,arguments)},l.fn.stepy.defaults={back:void 0,backLabel:'<i class="fa fa-angle-left"></i> Back',block:!1,description:!0,duration:void 0,enter:!0,errorImage:!1,finish:void 0,finishButton:!0,ignore:"",legend:!0,next:void 0,nextLabel:'Next <i class="fa fa-angle-right"></i>',select:void 0,titleClick:!1,titleTarget:void 0,transition:void 0,validate:!1}}(jQuery);