!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(f){var u={options:{optionClass:"",dropdownClass:"",autoinit:!1,callback:!1,onSelected:!1,dynamicOptLabel:"Add a new option..."},init:function(p){function o(n){if(!n.data("dropdownjs")&&n.is("select")){var o=n.attr("multiple"),t=n.attr("data-dynamic-opts"),d=f(),a=f("<div></div>");a.addClass("dropdownjs").addClass(p.dropdownStyle),a.data("select",n);var e=f("<input type=text readonly class=fakeinput>");f.material&&e.data("mdproc",!0),a.append(e);var i=f("<ul></ul>");i.data("select",n),a.append(i),e.attr("placeholder",n.attr("placeholder")),n.find("option").each(function(){var t=f(this);u._addOption(i,t)}),t&&((d=f("<li class=dropdownjs-add></li>")).append("<input>"),d.find("input").attr("placeholder",p.dynamicOptLabel),i.append(d));a.find("li");if(o){var s=[],l=n.val();for(var r in l)s.push("li[value="+l[r]+"]");0<s.length&&u._select(a,a.find(s.join(",")))}else{var c;c=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),u._select(a,c)}e.addClass(n[0].className),n.hide().attr("data-dropdownjs",!0),n.after(a),p.callback&&p.callback(a),i.on("click","li:not(.dropdownjs-add)",function(t){u._select(a,f(this)),n.change()}),i.on("keydown","li:not(.dropdownjs-add)",function(t){return 27===t.which?(f(".dropdownjs > ul > li").attr("tabindex",-1),e.removeClass("focus").blur()):32!==t.which||f(t.target).is("input")?void 0:(u._select(a,f(this)),!1)}),i.on("focus","li:not(.dropdownjs-add)",function(){n.is(":disabled")||e.addClass("focus")}),t&&t.length&&d.on("keydown",function(t){if(13===t.which){var e=f("<option>"),o=d.find("input").val();d.find("input").val(""),e.attr("value",o),e.text(o),n.append(e)}}),n.on("DOMNodeInserted",function(t){var e=f(t.target);e.val().length&&(u._addOption(i,e),i.find("li").not(".dropdownjs-add").attr("tabindex",0))}),n.on("change",function(t){var e;f(t.target).val().length&&(o?u._select(a,n.find(":selected")):(e=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),u._select(a,e)))}),e.on("click focus",function(t){if(t.stopPropagation(),!n.is(":disabled")){f(".dropdownjs > ul > li").attr("tabindex",-1),f(".dropdownjs > input").not(f(this)).removeClass("focus").blur(),f(".dropdownjs > ul > li").not(".dropdownjs-add").attr("tabindex",0);var e={top:f(this).offset().top-f(document).scrollTop(),left:f(this).offset().left-f(document).scrollLeft(),bottom:f(window).height()-(f(this).offset().top-f(document).scrollTop()),right:f(window).width()-(f(this).offset().left-f(document).scrollLeft())},o=e.bottom;o<200&&e.bottom<e.top?(o=e.top,i.attr("placement","top-left")):i.attr("placement","bottom-left"),f(this).next("ul").css("max-height",o-20),f(this).addClass("focus")}}),f(document).on("click",function(t){o&&f(t.target).parents(".dropdownjs").length||f(t.target).parents(".dropdownjs-add").length||f(t.target).is(".dropdownjs-add")||(f(".dropdownjs > ul > li").attr("tabindex",-1),e.removeClass("focus"))})}}(p=p?f.extend(u.options,p):u.options).autoinit&&f(document).on("DOMNodeInserted",function(t){var e=f(t.target);e.is("select")||(e=e.find("select")),e.is(p.autoinit)&&e.each(function(){o(f(this))})}),f(this).each(function(){o(f(this))})},select:function(t){var e=f(this).find('[value="'+t+'"]');u._select(f(this),e)},_select:function(t,e){if(!e.is(".dropdownjs-add")){var o=t.data("select"),n=t.find("input.fakeinput"),d=o.attr("multiple"),a=t.find("li");if(d){e.toggleClass("selected"),e.each(function(){o.find('[value="'+f(this).attr("value")+'"]').prop("selected",f(this).hasClass("selected"))});var i=[];a.each(function(){f(this).hasClass("selected")&&i.push(f(this).text())}),n.val(i.join(", "))}d||(e.is("li")&&a.not(e).removeClass("selected"),e.addClass("selected"),o.val(e.attr("value")),n.val(e.text().trim())),f.material&&(n.val().trim()?o.removeClass("empty"):o.addClass("empty")),this.options.onSelected&&this.options.onSelected(e.attr("value"))}},_addOption:function(t,e){var o=f("<li></li>");o.addClass(this.options.optionStyle),e.text()?o.text(e.text()):o.html("&nbsp;"),o.attr("value",e.val()),t.data("select").attr("data-dynamic-opts")&&(o.append("<span class=close></span>"),o.find(".close").on("click",function(){o.remove(),e.remove()})),e.prop("selected")&&(o.attr("selected",!0),o.addClass("selected")),t.find(".dropdownjs-add").length?t.find(".dropdownjs-add").before(o):t.append(o)}};f.fn.dropdown=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof t|!t?u.init.apply(this,arguments):void f.error("Method "+t+" does not exists on jQuery.dropdown")}});