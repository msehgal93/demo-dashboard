!function(a){var i=function(t){this.tipPosition={x:0,y:0},this.init(t)};i.prototype.init=function(c){function e(t){var i={};i.x=t.pageX,i.y=t.pageY,c.setTooltipPosition(i)}function s(t,d,i){var u=function(t,i,e,s){return Math.sqrt((e-t)*(e-t)+(s-i)*(s-i))};if(i)c.showTooltip(i,d);else if(o.plotOptions.series.lines.show&&!0===o.tooltipOptions.lines){var e=o.plotOptions.grid.mouseActiveRadius,x={distance:e+1};a.each(c.getData(),function(t,i){for(var e=0,s=-1,o=1;o<i.data.length;o++)i.data[o-1][0]<=d.x&&i.data[o][0]>=d.x&&(e=o-1,s=o);if(-1!==s){var a={x:i.data[e][0],y:i.data[e][1]},n={x:i.data[s][0],y:i.data[s][1]},r=function(p,l,d,x,c,h,t){if(!t||(t=function(t,i,e,s,o,a){if(void 0!==d)return{x:d,y:l};if(void 0!==x)return{x:p,y:x};var n,r=-1/((h-x)/(c-d));return{x:n=(c*(p*r-l+x)+d*(p*-r+l-h))/(r*(c-d)+x-h),y:r*n-r*p+l}}()).x>=Math.min(d,c)&&t.x<=Math.max(d,c)&&t.y>=Math.min(x,h)&&t.y<=Math.max(x,h)){var i=x-h,e=c-d,s=d*h-x*c;return Math.abs(i*p+e*l+s)/Math.sqrt(i*i+e*e)}var o=u(p,l,d,x),a=u(p,l,c,h);return a<o?a:o}(i.xaxis.p2c(d.x),i.yaxis.p2c(d.y),i.xaxis.p2c(a.x),i.yaxis.p2c(a.y),i.xaxis.p2c(n.x),i.yaxis.p2c(n.y),!1);if(r<x.distance){var p=u(a.x,a.y,d.x,d.y)<u(d.x,d.y,n.x,n.y)?e:s,l=(i.datapoints.pointsize,[d.x,a.y+(n.y-a.y)*((d.x-a.x)/(n.x-a.x))]);x={distance:r,item:{datapoint:l,dataIndex:p,series:i,seriesIndex:t}}}}else c.hideTooltip()}),x.distance<e+1?c.showTooltip(x.item,d):c.hideTooltip()}else c.hideTooltip()}var o=this,t=a.plot.plugins.length;if(this.plotPlugins=[],t)for(var i=0;i<t;i++)this.plotPlugins.push(a.plot.plugins[i].name);c.hooks.bindEvents.push(function(t,i){o.plotOptions=t.getOptions(),!1!==o.plotOptions.tooltip&&void 0!==o.plotOptions.tooltip&&(o.tooltipOptions=o.plotOptions.tooltipOpts,o.tooltipOptions.$compat?(o.wfunc="width",o.hfunc="height"):(o.wfunc="innerWidth",o.hfunc="innerHeight"),o.getDomElement(),a(t.getPlaceholder()).bind("plothover",s),a(i).bind("mousemove",e))}),c.hooks.shutdown.push(function(t,i){a(t.getPlaceholder()).unbind("plothover",s),a(i).unbind("mousemove",e)}),c.setTooltipPosition=function(t){var i=o.getDomElement(),e=i.outerWidth()+o.tooltipOptions.shifts.x,s=i.outerHeight()+o.tooltipOptions.shifts.y;t.x-a(window).scrollLeft()>a(window)[o.wfunc]()-e&&(t.x-=e),t.y-a(window).scrollTop()>a(window)[o.hfunc]()-s&&(t.y-=s),o.tipPosition.x=t.x,o.tipPosition.y=t.y},c.showTooltip=function(t,i){var e=o.getDomElement(),s=o.stringFormat(o.tooltipOptions.content,t);e.html(s),c.setTooltipPosition({x:i.pageX,y:i.pageY}),e.css({left:o.tipPosition.x+o.tooltipOptions.shifts.x,top:o.tipPosition.y+o.tooltipOptions.shifts.y}).show(),"function"==typeof o.tooltipOptions.onHover&&o.tooltipOptions.onHover(t,e)},c.hideTooltip=function(){o.getDomElement().hide().html("")}},i.prototype.getDomElement=function(){var t=a("#"+this.tooltipOptions.id);return 0===t.length&&((t=a("<div />").attr("id",this.tooltipOptions.id)).appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&t.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),t},i.prototype.stringFormat=function(t,i){var e,s,o,a,n=/%s/,r=/%lx/,p=/%ly/,l=/%x\.{0,1}(\d{0,})/,d=/%y\.{0,1}(\d{0,})/;if(o=void 0!==i.series.threshold?(e=i.datapoint[0],s=i.datapoint[1],i.datapoint[2]):void 0!==i.series.lines&&i.series.lines.steps?(e=i.series.datapoints.points[2*i.dataIndex],s=i.series.datapoints.points[2*i.dataIndex+1],""):(e=i.series.data[i.dataIndex][0],s=i.series.data[i.dataIndex][1],i.series.data[i.dataIndex][2]),null===i.series.label&&i.series.originSeries&&(i.series.label=i.series.originSeries.label),"function"==typeof t&&(t=t(i.series.label,e,s,i)),void 0!==i.series.percent?a=i.series.percent:void 0!==i.series.percents&&(a=i.series.percents[i.dataIndex]),"number"==typeof a&&(t=this.adjustValPrecision(/%p\.{0,1}(\d{0,})/,t,a)),t=void 0!==i.series.label?t.replace(n,i.series.label):t.replace(n,""),t=this.hasAxisLabel("xaxis",i)?t.replace(r,i.series.xaxis.options.axisLabel):t.replace(r,""),t=this.hasAxisLabel("yaxis",i)?t.replace(p,i.series.yaxis.options.axisLabel):t.replace(p,""),this.isTimeMode("xaxis",i)&&this.isXDateFormat(i)&&(t=t.replace(l,this.timestampToDate(e,this.tooltipOptions.xDateFormat,i.series.xaxis.options))),this.isTimeMode("yaxis",i)&&this.isYDateFormat(i)&&(t=t.replace(d,this.timestampToDate(s,this.tooltipOptions.yDateFormat,i.series.yaxis.options))),"number"==typeof e&&(t=this.adjustValPrecision(l,t,e)),"number"==typeof s&&(t=this.adjustValPrecision(d,t,s)),void 0!==i.series.xaxis.ticks){var x;x=this.hasRotatedXAxisTicks(i)?"rotatedTicks":"ticks";var c=i.dataIndex+i.seriesIndex;if(i.series.xaxis[x].length>c&&!this.isTimeMode("xaxis",i))(this.isCategoriesMode("xaxis",i)?i.series.xaxis[x][c].label:i.series.xaxis[x][c].v)===e&&(t=t.replace(l,i.series.xaxis[x][c].label))}if(void 0!==i.series.yaxis.ticks)for(var h in i.series.yaxis.ticks)if(i.series.yaxis.ticks.hasOwnProperty(h)){(this.isCategoriesMode("yaxis",i)?i.series.yaxis.ticks[h].label:i.series.yaxis.ticks[h].v)===s&&(t=t.replace(d,i.series.yaxis.ticks[h].label))}return void 0!==i.series.xaxis.tickFormatter&&(t=t.replace("%x",i.series.xaxis.tickFormatter(e,i.series.xaxis).replace(/\$/g,"$$"))),void 0!==i.series.yaxis.tickFormatter&&(t=t.replace("%y",i.series.yaxis.tickFormatter(s,i.series.yaxis).replace(/\$/g,"$$"))),o&&(t=t.replace("%ct",o)),t},i.prototype.isTimeMode=function(t,i){return void 0!==i.series[t].options.mode&&"time"===i.series[t].options.mode},i.prototype.isXDateFormat=function(){return void 0!==this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},i.prototype.isYDateFormat=function(){return void 0!==this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},i.prototype.isCategoriesMode=function(t,i){return void 0!==i.series[t].options.mode&&"categories"===i.series[t].options.mode},i.prototype.timestampToDate=function(t,i,e){var s=a.plot.dateGenerator(t,e);return a.plot.formatDate(s,i,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},i.prototype.adjustValPrecision=function(t,i,e){var s;return null!==i.match(t)&&""!==RegExp.$1&&(s=RegExp.$1,e=e.toFixed(s),i=i.replace(t,e)),i},i.prototype.hasAxisLabel=function(t,i){return-1!==a.inArray(this.plotPlugins,"axisLabels")&&void 0!==i.series[t].options.axisLabel&&0<i.series[t].options.axisLabel.length},i.prototype.hasRotatedXAxisTicks=function(t){return-1!==a.inArray(this.plotPlugins,"tickRotor")&&void 0!==t.series.xaxis.rotatedTicks};a.plot.plugins.push({init:function(t){new i(t)},options:{tooltip:!1,tooltipOpts:{id:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,lines:!1,onHover:function(){},$compat:!1}},name:"tooltip",version:"0.8.4"})}(jQuery);